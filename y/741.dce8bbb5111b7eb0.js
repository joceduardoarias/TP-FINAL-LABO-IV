"use strict";(self.webpackChunktpfinal=self.webpackChunktpfinal||[]).push([[741],{741:(D,d,l)=>{l.r(d),l.d(d,{GenerarTurnosModule:()=>q});var u=l(9808),g=l(441),t=l(5e3),m=l(4775);function b(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"button",2),t.NdJ("click",function(){const a=t.CHM(i).$implicit;return t.oxw().emitirEspecialidad(a)}),t._uU(2),t.qZA()()}if(2&e){const i=r.$implicit;t.xp6(2),t.Oqu(i)}}let _=(()=>{class e{constructor(i){this.cargarhora=i,this.list=[],this.encontrado=!1,this.especialidad=new t.vpe,i.getAll().valueChanges().subscribe(o=>{for(let s=0;s<o.length;s++){const a=o[s].especialidad;this.list.includes(o[s].especialidad)||this.list.push(a)}})}ngOnInit(){}emitirEspecialidad(i){this.especialidad.emit(i)}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(m.q))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-elegir-especialidad"]],outputs:{especialidad:"especialidad"},decls:2,vars:1,consts:[[1,"container","c"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0),t.YNc(1,b,3,1,"div",1),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngForOf",o.list))},directives:[u.sg],styles:["img[_ngcontent-%COMP%]{display:block;height:100px;width:103px}.c[_ngcontent-%COMP%]{min-height:100vh;display:flex;justify-content:center;align-items:center}"]}),e})();function j(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"div",2),t._UZ(2,"img",3),t.TgZ(3,"div",4)(4,"button",5),t.NdJ("click",function(){const a=t.CHM(i).$implicit;return t.oxw().accion(a)}),t._uU(5),t.qZA()()()()}if(2&e){const i=r.$implicit;t.xp6(2),t.Q6J("src",i.imagen,t.LSH),t.xp6(3),t.Oqu(i.nombre)}}let v=(()=>{class e{constructor(){this.obj=new t.vpe}ngOnInit(){}accion(i){this.obj.emit(i)}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-elegir-especialista"]],inputs:{usuarios:"usuarios"},outputs:{obj:"obj"},decls:2,vars:1,consts:[[1,"container","c"],[4,"ngFor","ngForOf"],[1,"card",2,"width","10rem"],["alt","...",1,"card-img-top",3,"src"],[1,""],[1,"btn","btn-primary",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0),t.YNc(1,j,6,2,"div",1),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngForOf",o.usuarios))},directives:[u.sg],styles:[".c[_ngcontent-%COMP%]{min-height:100vh;display:flex;justify-content:center;align-items:center}button[_ngcontent-%COMP%]{width:100%}"]}),e})();class y{}class C{constructor(){this.hora=[]}}class x{}class f{constructor(r,i,o){this.fechas=[],this.email=r,this.especialidad=i,this.fechas=o}}class T{constructor(){this.correoPaciente="",this.correoEspecialista="",this.especialidad="",this.estado="",this.comentariopaciente="No hay comentario",this.comentarioespecialista="No hay comentario",this.comentarioadmin="No hay comentario",this.diagnostico="No hay comentario",this.hora="",this.minutos="",this.dia=""}}var E=l(2613),A=l(6136),w=l(7556);function Z(e,r){1&e&&t._UZ(0,"div",3)}function O(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(i);const s=t.oxw().$implicit,a=t.oxw().$implicit;return t.oxw(2).quehago(a.dia,s.hora,s.minutos)}),t._uU(1),t.qZA()}if(2&e){const i=t.oxw().$implicit;t.xp6(1),t.AsE("",i.hora,":",i.minutos," ")}}function M(e,r){if(1&e&&(t.TgZ(0,"div",7),t.YNc(1,O,2,2,"button",8),t.qZA()),2&e){const i=r.$implicit;t.xp6(1),t.Q6J("ngIf","habilitado"==i.estado)}}function F(e,r){if(1&e&&(t.TgZ(0,"div")(1,"button",5),t._uU(2),t.qZA(),t.YNc(3,M,2,1,"div",6),t.qZA()),2&e){const i=r.$implicit;t.xp6(2),t.hij(" ",i.dia," "),t.xp6(1),t.Q6J("ngForOf",i.horario)}}function H(e,r){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,F,4,2,"div",4),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("ngForOf",i.arraytercero)}}let J=(()=>{class e{constructor(i,o,s){this.hsturnos=i,this.mixto=o,this.auth=s,this.cargando=!0,this.ahora=new Date,this.arrayHorarios=[],this.arraytercero=[],this.unobj=new T,setTimeout(()=>{this.cargando=!1},1200)}ngOnInit(){this.calculartiempo(this.ahora,this.objectoActual.dias,this.objectoActual.hora.horamin,this.objectoActual.hora.horamax).then(i=>{this.desub=this.hsturnos.getAll().valueChanges().subscribe(o=>{this.desub.unsubscribe(),this.objectoguardar=new f(this.objectoActual.email,this.objectoActual.especialidad,i),0==o.length?this.hsturnos.create(this.objectoguardar).then(s=>{}):this.hsturnos.getAll().valueChanges().subscribe(s=>{for(let a=0;a<s.length;a++)if(s[a].email==this.objectoguardar.email&&s[a].especialidad==this.objectoguardar.especialidad)for(let n=0;n<this.objectoguardar.fechas.length;n++)for(let c=0;c<s[a].fechas.length;c++)if(this.objectoguardar.fechas[n].dia==s[a].fechas[c].dia)for(let p=0;p<this.objectoguardar.fechas[n].horario.length;p++)for(let h=0;h<s[a].fechas[c].horario.length;h++)this.objectoguardar.fechas[n].horario[p].hora==s[a].fechas[c].horario[h].hora&&this.objectoguardar.fechas[n].horario[p].minutos==s[a].fechas[c].horario[h].minutos&&(this.objectoguardar.fechas[n].horario[p].estado=s[a].fechas[c].horario[h].estado)})})})}calculartiempo(i,o,s,a){return new Promise((n,c)=>{for(let p=0;p<14;p++){let h=new y;if(this.ahora.setHours(s),this.ahora.setMinutes(0),this.ahora.setSeconds(0),this.arrayHorarios=new Array,this.ahora.getDay()==o[0]||this.ahora.getDay()==o[1]||this.ahora.getDay()==o[2]||this.ahora.getDay()==o[3]||this.ahora.getDay()==o[4]||this.ahora.getDay()==o[5]||this.ahora.getDay()==o[6]){for(;i.getHours()<a;)this.hs=new C,this.dat=new x,this.dat.hora=i.getHours(),this.dat.minutos=i.getMinutes(),this.dat.estado="habilitado",0==this.dat.minutos&&(this.dat.minutos="00"),this.hs=this.dat,this.arrayHorarios.push(this.hs),this.ahora.setMinutes(this.ahora.getMinutes()+30);h.dia=i.toLocaleDateString("en-GB"),h.horario=this.arrayHorarios,this.arraytercero.push(h)}i.setDate(i.getDate()+1)}n(this.arraytercero)})}quehago(i,o,s){for(let a=0;a<this.arraytercero.length;a++)if(this.arraytercero[a].dia==i)for(let n=0;n<this.arraytercero[a].horario.length;n++)this.arraytercero[a].horario[n].hora==o&&this.arraytercero[a].horario[n].minutos==s&&(this.arraytercero[a].horario[n].estado="deshabilitado",this.datin={dia:i,hora:this.arraytercero[a].horario[n].hora,minutos:this.arraytercero[a].horario[n].minutos});this.objectoguardar=new f(this.objectoActual.email,this.objectoActual.especialidad,this.arraytercero),this.buscar(this.objectoActual.email,this.objectoActual.especialidad).then(a=>{null==a?(this.hsturnos.create(this.objectoguardar),this.buscar(this.objectoActual.email,this.objectoActual.especialidad).then(n=>{this.hsturnos.getAll().update(n,this.objectoguardar).then(c=>{this.unobj.correoEspecialista=this.objectoguardar.email,this.unobj.correoPaciente=this.auth.correologeado,this.unobj.estado="pendiente",this.unobj.especialidad=this.objectoActual.especialidad,this.unobj.dia=this.datin.dia,this.unobj.hora=this.datin.hora,this.unobj.minutos=this.datin.minutos,this.mixto.create(this.unobj)})})):this.hsturnos.getAll().update(a,this.objectoguardar).then(n=>{this.unobj.correoEspecialista=this.objectoguardar.email,this.unobj.correoPaciente=this.auth.correologeado,this.unobj.estado="pendiente",this.unobj.especialidad=this.objectoActual.especialidad,this.unobj.dia=this.datin.dia,this.unobj.hora=this.datin.hora,this.unobj.minutos=this.datin.minutos,this.mixto.create(this.unobj)})})}buscar(i,o){return new Promise((s,a)=>{this.hsturnos.getAll().query.get().then(n=>(n.forEach(c=>{if(console.log(c.val().email),i==c.val().email&&o==c.val().especialidad)return s(c.key)}),s(null)))})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(E.l),t.Y36(A.n),t.Y36(w.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-elegir-horarios"]],inputs:{objectoActual:"objectoActual"},decls:4,vars:2,consts:[[1,"d"],["class","spinner-border","role","status",4,"ngIf"],["class","d",4,"ngIf"],["role","status",1,"spinner-border"],[4,"ngFor","ngForOf"],[1,"btn","btn-danger"],["class","efe",4,"ngFor","ngForOf"],[1,"efe"],["id","bb","class","btn btn-primary",3,"click",4,"ngIf"],["id","bb",1,"btn","btn-primary",3,"click"]],template:function(i,o){1&i&&(t.TgZ(0,"div",0)(1,"div"),t.YNc(2,Z,1,0,"div",1),t.qZA(),t.YNc(3,H,2,1,"div",2),t.qZA()),2&i&&(t.xp6(2),t.Q6J("ngIf",o.cargando),t.xp6(1),t.Q6J("ngIf",!o.cargando))},directives:[u.O5,u.sg],styles:[".d[_ngcontent-%COMP%]{min-height:100vh;display:flex;justify-content:center;align-items:center}#bb[_ngcontent-%COMP%]{width:90px}.efe[_ngcontent-%COMP%]{min-height:50px}#ep[_ngcontent-%COMP%]{display:block;margin-right:50px}.pp[_ngcontent-%COMP%]{padding-right:200px}"]}),e})();function N(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"app-elegir-especialidad",3),t.NdJ("especialidad",function(s){return t.CHM(i),t.oxw().recibir(s)}),t.qZA()}}function I(e,r){if(1&e){const i=t.EpF();t.TgZ(0,"app-elegir-especialista",4),t.NdJ("obj",function(s){return t.CHM(i),t.oxw().objectomodificar(s)}),t.qZA()}if(2&e){const i=t.oxw();t.Q6J("usuarios",i.usuarios)}}function Y(e,r){if(1&e&&t._UZ(0,"app-elegir-horarios",5),2&e){const i=t.oxw();t.Q6J("objectoActual",i.objbuscar)}}const P=[{path:"",component:(()=>{class e{constructor(i){this.cargarhora=i,this.boolespecialidad=!0,this.boolespecialista=!1,this.boolhorarios=!1,this.usuarios=[]}ngOnInit(){}recibir(i){this.boolespecialidad=!1,this.boolespecialista=!0,this.especialidad=i,this.cargarhora.getAll().valueChanges().subscribe(o=>{this.usuarios=[];for(let s=0;s<o.length;s++)o[s].especialidad==this.especialidad&&this.usuarios.push(o[s])})}objectomodificar(i){this.objbuscar=i,this.boolespecialidad=!1,this.boolespecialista=!1,this.boolhorarios=!0}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(m.q))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-turnosprincipal"]],decls:3,vars:3,consts:[[3,"especialidad",4,"ngIf"],[3,"usuarios","obj",4,"ngIf"],[3,"objectoActual",4,"ngIf"],[3,"especialidad"],[3,"usuarios","obj"],[3,"objectoActual"]],template:function(i,o){1&i&&(t.YNc(0,N,1,0,"app-elegir-especialidad",0),t.YNc(1,I,1,1,"app-elegir-especialista",1),t.YNc(2,Y,1,1,"app-elegir-horarios",2)),2&i&&(t.Q6J("ngIf",o.boolespecialidad),t.xp6(1),t.Q6J("ngIf",o.boolespecialista),t.xp6(1),t.Q6J("ngIf",o.boolhorarios))},directives:[u.O5,_,v,J],styles:[""]}),e})()}];let Q=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(P)],g.Bz]}),e})(),q=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,Q]]}),e})()}}]);